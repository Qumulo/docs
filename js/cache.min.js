(function(h,q){function m(){h[d]||(h[d]={});return h[d]}var d="app",f;f=m();f.namespace=f.ns=function(f,b){if(f){f=String(f);var n=f.split("."),e=n.length,a=h[d],c;a||(h[d]={});if(!n)return!1;for(c=0;c<e;c+=1)a[n[c]]||(a[n[c]]={}),c===e-1&&b!==q&&(a[n[c]]=b),a=a[n[c]];return a}return!1};h[d]=f;h.getNamespace=h.getNs=m})(window);
(function(h,q){function m(){if(!(this instanceof m))return new m;this.m=[];this.r=null;this.f=!1}m.prototype=m.fn={add:function(d){this.f?d(this.r):this.m.push(d)},flush:function(d){if(!this.f)for(this.r=d,this.f=!0;this.m[0];)this.m.shift()(d)}};h.ns("helpers.queue",m)})(window.getNs());
(function(h,q,m,d){var f=function(){var h=[];return{isString:function(b){return"string"===typeof b||b instanceof String},isFunction:function(b){f.isFunction=Object.prototype&&Object.prototype.toString?function(b){return"[object Function]"===Object.prototype.toString.call(b)}:function(b){return"function"===typeof b||b instanceof Function};return f.isFunction(b)},isArray:function(b){var d=Array.isArray,e=Object.prototype.toString;f.isFunction(d)?f.isArray=function(a){return d(a)}:f.isFunction(e)?f.isArray=
function(a){return"[object Array]"===e.call(a)}:f.isArray=function(a){return!!a&&f.isFunction(a.sort)};return f.isArray(b)},inArray:function(b,d,e){f.inArray=Array.prototype&&Array.prototype.indexOf?function(a,c,g){return h.indexOf.call(c,a,g)}:function(a,c,g){var l=c.length,u=0;if(g)return c[g]&&c[g]===a?g:-1;for(u=0;u<l;u+=1)if(c[u]===a)return u;return-1};return f.inArray(b,d,e)},callback:function(b){f.isFunction(b)||(b=function(){return d});return b},url:function(b){if(f.isString(b)){var d=q.createElement("a"),
e;d.href=b;e=d.pathname.match(/\/([^\/?#]+)$/i);return{source:b,protocol:d.protocol,host:d.hostname,port:d.port,query:d.search,file:e?e[1]:"/",hash:d.hash,path:d.pathname.replace(/^([^\/])/,"/$1"),extension:function(a){a=a.split(".");return a.length?a[a.length-1]:!1}(b),folder:function(){var a=b.lastIndexOf("/");return b.substr(0,a+1)}()}}},trim:function(b){if(!f.isString(b))return b;f.isFunction(String.prototype.trim)||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});return b.trim()}}}();
m.ns("helpers.utils",f)})(window,document,window.getNs());(function(h,q,m,d){m.namespace("helpers.console",{})})(window,document,window.getNs());
(function(h,q,m){var d=function(){var f=q.helpers.utils;return{getXhr:function(){for(var d=null,b=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],f=b.length,e=0,e=0;e<f;e+=1){try{d=b[e]()}catch(a){continue}break}return d},xhr:function(h,b,n,e){var a=d.getXhr(),c,g="GET";b=f.callback(b);if(a)if(h){e!==m?g="POST":e=null;n===m&&(n=!0);c=function(){if(4===
a.readyState&&(200<=a.status&&400>a.status||0===a.status))try{var c=a.responseText;c?b(c):b(!1)}catch(g){b(!1)}else 4===a.readyState&&b(!1)};a.open(g,h,n);try{a.onreadystatechange!==m?a.onreadystatechange=c:a.onload!==m&&(a.onload=c)}catch(l){}a.send(e)}else b(!1);else b(!1)}}}();q.namespace("helpers.ajax",d)})(window,window.getNs());
(function(h,q,m,d){var f=function(){return{on:function(d,b,n){f.on="function"===typeof h.addEventListener?function(e,a,c){e.addEventListener(a,c,!1)}:"function"===typeof q.attachEvent?function(e,a,c){e.attachEvent("on"+a,c)}:function(e,a,c){e["on"+a]=c};f.on(d,b,n)},off:function(d,b,n){f.off="function"===typeof h.removeEventListener?function(e,a,c){e.removeEventListener(a,c,!1)}:"function"===typeof q.detachEvent?function(e,a,c){e.detachEvent("on"+a,c)}:function(e,a){e["on"+a]=null};f.off(d,b,n)}}}();
m.namespace("helpers.events",f)})(window,document,window.getNs());(function(h,q,m,d){var f=function(){var p=null,b=h.JSON;return{getJson:function(){null===p&&b&&b.stringify&&(p=b);return p},jsonToString:function(b,e,a){var c=!1;null===p&&(p=f.getJson());p&&(p.stringify&&b!==d)&&(c=p.stringify(b,e,a));return c},jsonToObject:function(b,e){var a=!1;null===p&&(p=f.getJson());p&&(p.parse&&b!==d)&&(a=p.parse(String(b),e));return a}}}();m.namespace("helpers.json",f)})(window,document,window.getNs());
(function(h,q,m,d){var f=function(){function f(){a===d&&(l(h,"online",f),l(h,"offline",f));a=q.onLine!==d?!!q.onLine:!0}var b,n,e,a,c,g=(q.userAgent||q.vendor||h.opera).toLowerCase(),l=m.helpers.events.on;return{isWebkit:function(){b===d&&(b=null!==g.match(/(webkit)/));return b},isMsie:function(){e===d&&(e=null!==g.match(/(msie)/));return e},isOpera:function(){n===d&&(n=null!==g.match(/(opera)/));return n},isOnline:function(){a===d&&f();return a},hasCanvas:function(){if(c===d){var a=document.createElement("canvas");
c=!(!a.getContext||!a.getContext("2d"))}return c}}}();m.ns("helpers.client",f)})(window,window.navigator,window.getNs());
(function(h,q,m){function d(d,b){b&&(b.dom?d=b.dom:b.id&&(d=h.getElementById(b.id)));return d}var f=function(){var p=q.helpers,b=p.utils,n=p.client,e=[],a=[],c=[],g=[],l=h.getElementsByTagName("head")[0];return{nuke:function(){e=[];a=[];c=[];g=[]},createDomNode:function(c,a){var g=h.createElement(c),l;if(a)for(l in a)a.hasOwnProperty(l)&&g.setAttribute(l,a[l]);return g},getAttribute:function(c,a){return c.getAttribute(a)},setAttribute:function(c,a,g){c.setAttribute(a,g)},appendCss:function(c,a,g,
s,k){if(-1===b.inArray(c,e)||k){var r=null,t=!1,v,m,r=d(r,s);if(null!==a){r||(r=f.createDomNode("style",{type:"text/css"}),r.className="lazyloaded");r.onerror=function(){g(!1)};s||l.appendChild(r);try{v=h.createTextNode(a),r.appendChild(v)}catch(w){r.styleSheet.cssText=a}finally{g(!0)}}else null!==c&&(r||(r=f.createDomNode("link",{rel:"stylesheet",type:"text/css"}),r.className="lazyloaded"),r.onerror=r.error=function(){r.onload=r.load=null;t=!0;window.clearTimeout(m);g(!1)},s||l.appendChild(r),n.isMsie()||
n.isOpera()?r.onload=r.load=function(){r.onerror=r.error=null;t=!0;window.clearTimeout(m);g(!0)}:g(!0),r.href=c,m=window.setTimeout(function(){t||g(!1)},4E3));e.push(c)}else g(!0)},appendJs:function(c,g,e,s,k){if(-1===b.inArray(c,a)||k){k=f.createDomNode("script");var r=h.getElementsByTagName("script")[0],t=!1,v=!1,m;(k=d(k,s))?(k.type="text/javascript",k.className="lazyloaded",k.async=!0,k.onreadystatechange=k.onload=function(){v||this.readyState&&"complete"!==this.readyState&&"loaded"!==this.readyState||
(this.onreadystatechange=this.onload=null,t=v=!0,window.clearTimeout(m),a.push(c),e(!0))},k.onerror=function(){this.onload=this.onreadystatechange=this.onerror=null;window.clearTimeout(m);t=!0;e(!1)},s||(r?r.parentNode.insertBefore(k,r):l.appendChild(k)),g&&!v?(k.textContent?k.textContent=g:k.nodeValue?k.nodeValue=g:k.text=g,t=v=!0):null!==c&&(k.src=c),v&&(a.push(c),t=!0,e(!0)),t||(m=window.setTimeout(function(){v||e(!1)},5E3))):e(!1)}else e(!0)},appendImg:function(a,g,l,e){var k=null;(k=d(k,e))||
(k=new Image);k.onerror=function(){k.onload=k.onerror=null;l(!1)};k.onload=function(){k.onload=k.onerror=null;l(!0)};g?k.src=g:a&&(k.src=a);if(k.complete&&k.naturalWidth!==m)k.onload();c.push(a)},appendHtml:function(c,a,l,e){var k=d(null,e);if(k){if(a)try{k.innerHTML=a,e.id&&n.isMsie()&&h.styleSheets[0].addRule("#"+e.id+":after",'content: " ";')}catch(b){k.innerText=a}l(!0);g.push(c)}else l(!1)}}}();q.ns("helpers.dom",f)})(document,window.getNs());
(function(h,q,m){function d(c,a,e){var b=function(a){e(!1)};if("."===a[0]||""===a[0])a=a.slice(1);a[0]?c.getDirectory(a[0],{create:!0},function(c){a.length?d(c,a.slice(1),e):e(!0)},b):e(!0)}function f(c,a,b){a=a.split("/");var f=a.length,h="",s=0;b=e(b);if(f){for(s=0;s<f-1;s+=1)h=h+a[s]+"/";d(c.root,h.split("/"),b)}else b(!0)}function p(a){if(!(this instanceof p))return new p(a);this.adapter=null;this.type=b;this.size=52428800;this.init(a)}var b="fileSystem";m=q.helpers;var n=m.json,e=m.utils.callback,
a=null,c=h.requestFileSystem||h.webkitRequestFileSystem||h.moz_requestFileSystem;p.prototype=p.fn={isSupported:function(){null===a&&(a=!!c&&(!!h.Blob||!!h.BlobBuilder)&&h.FileReader);return a},open:function(g){var l=this,b=l.adapter,d=function(a){g(!1)};g=e(g);a?null===b?(h.requestFileSystem=c,h.requestFileSystem(h.TEMPORARY,l.size,function(a){b=l.adapter=a;try{l.create("test-item",n.jsonToString({test:"test-content"}),function(a){a?l.remove("test-item",function(){g(b)}):g(!1)})}catch(c){g(!1)}},
d)):g(b):g(!1)},create:function(c,l,b){b=e(b);if(c&&a){var d=this.adapter,h=function(a){b(!1,a)};f(d,c,function(){d.root.getFile(c,{create:!0},function(a){a.createWriter(function(a){var c;a.onwriteend=function(){b(!0)};a.onerror=h;try{Blob?(c=new Blob([l],{type:"text/plain"}),a.write(c)):BlobBuilder&&(c=new BlobBuilder,c.append(l),a.write(c.getBlob("application/json")))}catch(g){h(g)}},h)},h)})}else b(!1)},read:function(c,l){l=e(l);if(c&&a){var b=this.adapter,d=function(a){l(!1,a)};f(b,c,function(){b.root.getFile(c,
{create:!1},function(a){a.file(function(a){var c=new FileReader;c.onloadend=function(){l(this.result)};c.onerror=d;c.onabort=d;c.readAsText(a)},d)},d)})}else l(!1)},update:function(a,c,e){this.create(a,c,e)},remove:function(c,l){l=e(l);if(c&&a){var b=this.adapter,d=function(a){l(!1,a)};f(b,c,function(){b.root.getFile(c,{create:!1},function(a){a.remove(function(){l(!0)},d)},d)})}else l(!1)},init:function(a){return this.isSupported()?(a&&a.size&&(this.size=a.size),this):!1}};q.ns("cache.storage.adapter."+
b,p)})(window,window.getNs());
(function(h,q,m){function d(b){if(!(this instanceof d))return new d(b);this.adapter=null;this.type=f;this.dbName="cache";this.dbVersion="1.0";this.dbTable="offline";this.dbDescription="offline cache";this.dbKey="key";this.init(b)}var f="indexedDatabase",p=q.helpers.utils.callback,b=null,n=h.indexedDB||h.webkitIndexedDB||h.mozIndexedDB||h.OIndexedDB||h.msIndexedDB;d.prototype=d.fn={isSupported:function(){null===b&&(b=!!n);return b},create:function(e,a,c){c=p(c);if(e&&b){var g=this.dbTable,l=this.adapter.transaction([g],
"readwrite");e=l.objectStore(g).put({key:e,content:a});l.onerror=function(a){c(!1,a)};e.onerror=function(a){c(!1,a)};e.onsuccess=function(){c(!0)}}else c(!1)},read:function(e,a){a=p(a);if(e&&b){var c=this.dbTable,g=this.adapter.transaction([c],"readonly"),c=g.objectStore(c).get(e);g&&c?(g.onerror=function(c){a(!1,c)},c.onerror=function(c){a(!1,c)},c.onsuccess=function(c){c.target.result&&c.target.result.content?a(c.target.result.content):a(!1)}):a(!1)}else a(!1)},update:function(b,a,c){this.create(b,
a,c)},remove:function(e,a){a=p(a);if(e&&b){var c=this.dbTable,g=this.adapter.transaction([c],"readwrite"),c=g.objectStore(c).put({key:e,content:""});g.onerror=function(c){a(!1,c)};c.onerror=function(c){a(!1,c)};c.onsuccess=function(){a(!0)}}else a(!1)},open:function(b,a){a||(a=!1);b=p(b);var c=this,g=null,l=null,d=null,f=c.dbName,q=c.dbTable,s=function(a){a||b(!1);c.create("test-item",'{test: "test-content"}',function(g){g?c.remove("test-item",function(){b(a)}):b(!1)})},k,r,t,v,C;if(null===c.adapter)if(g=
n){h.webkitIndexedDB!==m&&(h.IDBTransaction=h.webkitIDBTransaction,h.IDBKeyRange=h.webkitIDBKeyRange);k=function(a){a.createIndex(c.dbKey,c.dbKey,{unique:!0});a.createIndex("content","content",{unique:!1})};r=function(a){var g=l.result,f,h;c.adapter=g;c.dbVersion===g.version||!g.setVersion&&"function"!==typeof g.setVersion?(c.adapter=g,s(g)):(d=a.currentTarget.result.setVersion(c.dbVersion),d.onfailure=function(a){b(!1)},d.onsuccess=function(a){f=l.result;try{h=f.createObjectStore(q,{keyPath:c.dbKey}),
k(h)}catch(g){b(!1)}})};t=function(a){a=l.result.createObjectStore(q,{keyPath:c.dbKey});k(a)};v=function(g){a||c.open(b,!0);b(!1)};C=function(a){b(!1)};if(a)try{l=g.open(f,c.dbVersion)}catch(w){l=g.open(f)}else l=g.open(f);l.onsuccess=r;l.onupgradeneeded=t;l.onerror=v;l.onblocked=C}else b(!1);else s(c.adapter)},init:function(b){return this.isSupported()?(b&&(b.name&&(this.dbName=String(b.name)),b.version&&(this.dbVersion=parseInt(b.version,10)),b.table&&(this.dbTable=b.table),b.description&&(this.dbDescription=
String(b.description)),b.key&&(this.dbKey=b.key)),this):!1}};q.ns("cache.storage.adapter."+f,d)})(window,window.getNs());
(function(h,q,m){function d(a,c,g,b,d,e){!e&&a?a.transaction(function(a){a.executeSql(c,g,b,d)}):e?e.executeSql(c,g,b,d):d(null,{code:0,message:p+" isn't available"})}function f(a){if(!(this instanceof f))return new f(a);this.adapter=null;this.type=p;this.dbName="cache";this.dbVersion="1.0";this.dbDescription="resource cache";this.dbTable="websql";this.dbSize=4194304;this.init(a)}var p="webSqlDatabase",b=q.helpers.utils.callback,n=null,e=h.openDatabase;f.prototype=f.fn={isSupported:function(){null===
n&&(n=!!e);return n},create:function(a,c,g){g=b(g);a&&n?d(this.adapter,"INSERT INTO "+this.dbTable+" (key, content) VALUES (?,?);",[a,c],function(){g(!0)},function(a,c){g(!1,c,{transaction:a})}):g(!1)},read:function(a,c){c=b(c);a&&n?d(this.adapter,"SELECT content FROM "+this.dbTable+" WHERE key=?;",[a],function(a,b){var d=!1;b&&(b.rows&&1===b.rows.length)&&(d=b.rows.item(0).content);c(d,null,{transaction:a})},function(a,b){c(!1,b,{transaction:a})}):c(!1)},update:function(a,c,g){g=b(g);a&&n?d(this.adapter,
"UPDATE "+this.dbTable+" SET content = ?  WHERE key=?;",[c,a],function(){g(!0)},function(a,c){g(!1,c,{transaction:a})}):g(!1)},remove:function(a,c){c=b(c);a&&n?d(this.adapter,"DELETE FROM "+this.dbTable+" WHERE key = ?;",[a],function(){c(!0)},function(a,b){c(!1,b,{transaction:a})}):c(!1)},open:function(a){a=b(a);if(n){var c=this,g=c.adapter,l,f=function(b){b||a(!1);l=function(g){g?c.remove("test-item",function(){a(b)}):a(!1)};c.read("test-item",function(a){a?c.update("test-item",'{test: "test-content"}',
l):c.create("test-item",'{test: "test-content"}',l)})},m=function(a,b){d(a,"CREATE TABLE IF NOT EXISTS "+c.dbTable+"(id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, key TEXT NOT NULL UNIQUE, content TEXT NOT NULL);",[],function(){f(c.adapter)},function(a){f(!1)},b)},q=function(a){m(null,a)},s=function(c){a(!1)};try{if(null===g&&c.isSupported())if(c.adapter=g=e(c.dbName,"",c.dbDescription,c.dbSize),String(g.version)!==String(c.dbVersion)&&g.changeVersion&&"function"===typeof g.changeVersion)try{g.changeVersion(g.version,
c.dbVersion,q,s)}catch(k){a(!1)}else g=h.openDatabase(c.dbName,c.dbVersion,c.dbDescription,c.dbSize),m(g);else c.isSupported()&&f(g)}catch(r){a(!1)}}else a(!1)},init:function(a){return this.isSupported()?(a&&(a.description&&(this.dbDescription=a.description),a.name&&(this.dbName=a.name),a.size&&(this.dbSize=a.size),a.table&&(this.dbTable=a.table),a.version&&(this.dbVersion=String(a.version))),this):!1}};q.ns("cache.storage.adapter."+p,f)})(window,window.getNs());
(function(h,q,m){function d(a){a=n(a);switch(a){case "local":a="localStorage";break;case "session":a="sessionStorage";break;default:a="localStorage"}return a}function f(a){if(!(this instanceof f))return new f(a);this.adapter=null;this.type=p;this.lifetime="local";this.asynch=!0;this.init(a)}var p="webStorage",b=q.helpers.utils,n=b.trim,e=b.callback,a=null;f.prototype=f.fn={isSupported:function(){var c=d(this.lifetime);if(null===a)try{a=!!h[c]&&!!h[c].getItem}catch(b){a=!1}return a},create:function(a,
b,d){var f=this,h=!0,m=function(a){if(f.asynch)d(a);else return a};d=e(d);if(!a)return m(!1);try{f.adapter.setItem(a,b)}catch(s){h=!h}return m(h)},read:function(a,b){var d=this,f,h=!0,m=function(a){if(d.asynch)b(a);else return a};b=e(b);if(!a)return m(!1);try{h=(f=d.adapter.getItem(a))?f:!1}catch(s){h=!h}return m(h)},update:function(a,b,d){if(this.asynch)this.create(a,b,d);else return this.create(a,b,d)},remove:function(a,b){var d=this,f=!0,h=function(a){if(d.asynch)b(a);else return a};b=e(b);if(!a)return h(!1);
try{d.adapter.removeItem(a)}catch(m){f=!f}return h(f)},open:function(a){var b=this,f=b.adapter,m=d(b.lifetime),n,q,s=function(d){if(b.asynch)a(d);else return d};a=e(a);if(null===f)try{if(f=b.adapter=h[m],b.asynch)b.create("test-item",'{test: "test-content"}',function(d){d?b.remove("test-item",function(){a(f)}):a(!1)});else{if(n=b.create("test-item",'{test: "test-content"}'))if(q=b.remove("test-item"))return f;return!1}}catch(k){return s(!1)}else if(b.isSupported())return s(f)},init:function(a){return this.isSupported()?
(a&&(a.lifetime&&(this.lifetime=n(String(a.lifetime))),a.asynch!==m&&(this.asynch=!!a.asynch)),this):!1}};q.ns("cache.storage.adapter."+p,f)})(window,window.getNs());
(function(h,q,m,d){function f(a,c){c.isLoaded||(c.isLoaded=!0,c.progressCallback(100),h.setTimeout(function(){a()},c.delay))}function p(a){if(!(this instanceof p))return new p(a);this.adapter=null;this.type=b;this.isLoaded=!1;this.delay=0;this.opened=!0;this.message="New version available. Update page?";this.init(a)}var b="applicationCache",n=m.helpers,e=n.dom,a=n.events.on,c=n.utils.callback,g=null,l=q.getElementsByTagName("html")[0],u=h.applicationCache;p.prototype=p.fn={isSupported:function(){null===
g&&(g=!!u&&!!e.getAttribute(l,"manifest"));return g},open:function(b,g){var e=this,k=e.adapter,l=0,m,v;e.opened=!0;b=c(b);g&&g.progress&&(m=g.progress);m=e.progressCallback=c(m);if(e.isSupported()&&null!==k){v=function(){try{k.swapCache()}catch(a){}confirm(e.message)?h.location.reload(!0):f(b,e);return!1};a(k,"noupdate",function(){f(b,e);return!1});a(k,"downloading",function(){l=0;return!1});a(k,"progress",function(a){var c=0;e.delay=500;l+=1;c=a&&a.lengthComputable!==d?Math.round(100*a.loaded/a.total):
Math.round(100*l/20);m(c);return!1});a(k,"cached",function(){f(b,e);return!1});a(k,"updateready",function(){v()});a(k,"obsolete",function(){h.location.reload(!0);return!1});a(k,"error",function(){f(b,e);return!1});switch(k.status){case k.UNCACHED:f(b,e);break;case k.IDLE:f(b,e);break;case k.UPDATEREADY:v();break;case k.OBSOLETE:f(b,e)}a(h,"online",function(){try{k.update()}catch(a){}});h.setTimeout(function(){e.isLoaded||f(b,e)},12E3)}else f(b,e)},init:function(a){this.isSupported()&&(null===this.adapter&&
(this.adapter=u),a&&(a.message&&(this.message=String(a.message)),a.delay!==d&&(this.delay=parseInt(a.delay,10))));return this}};m.ns("cache.storage.adapter."+b,p)})(window,document,window.getNs());
(function(h,q,m,d){function f(a,c,b){b.timeoutXhr=h.setTimeout(function(){c(!1)},4E3);C(a,function(a){h.clearTimeout(b.timeoutXhr);delete b.timeoutXhr;a?c(a):c(!1)})}function p(a){var c=null;try{c=k.jsonToObject(a)}catch(b){}return c}function b(a,c,b){if(E){var g=q.createElement("canvas"),e,f=new Image,h=null,k=0,l=0;b||(b="jpeg");f.onerror=function(){f.onload=f.onerror=null;c()};f.onload=function(){f.onload=f.onerror=null;k=g.height=f.height;l=g.width=f.width;e=g.getContext("2d");e.fillStyle="rgba(50, 50, 50, 0)";
e.fillRect(0,0,l,k);e.drawImage(f,0,0);h=g.toDataURL("image/"+b);c(h)};x&&(f.src="");f.src=a;if(f.complete&&f.naturalWidth!==d)f.onload()}else c(!1)}function n(a){var c=a.data,b=a.url;"css"===a.type&&(b=s.url(b),b=b.folder,c=c.replace(/url\(\../g,"url("+b+".."),c=c.replace(/url\(\'../g,"url('"+b+".."),c=c.replace(/url\(\"../g,'url("'+b+".."),a.data=c);return a}function e(a,c){return{ajax:a.ajax,data:a.data,expires:(new Date).getTime()+(a.lifetime||c.lifetime),group:a.group!==d?a.group:c.group,lastmod:a.lastmod||
c.lastmod,lifetime:a.lifetime!==d?a.lifetime:c.lifetime,type:a.type||c.type,version:a.version||c.version}}function a(a,c,d){var g=a.type,e=a.url,h=a.data;a.ajax?"img"===g?b(e,c):f(e,c,a):h?c(h):d(!1)}function c(a){return B&&B[a]?!!B[a]:!1}function g(a,c){var b=null,d,f;a&&a.length?(d=a[0].type,f=a.slice(1),A[d]?b=new A[d](D):g(f,c),b&&b.isSupported()?b.open(function(d){d?(B=a[0],c(b)):g(f,c)}):g(f,c)):c(!1)}function l(a,c,b){var d=null,f=0,e;if(b)try{A[b]?(d=new A[b](D))&&d.isSupported()?d.open(function(g){if(g){e=
c.length;for(f=0;f<e;f+=1)c[f].type===b&&(B=c[f]);B?a(d):l(a,c)}else l(a,c)}):l(a,c):l(a,c)}catch(h){l(a,c)}else g(c,a)}function u(a,c){if(!(this instanceof u))return new u(a,c);this.isEnabled=!0;this.appCacheAdapter=this.adapter=null;this.adapters={types:F,defaults:D};this.resources={defaults:G};this.init(a,c)}var y=m.helpers,z=y.client,s=y.utils,k=y.json,y=y.ajax,r=s.isArray,t=s.callback,v=k.getJson(),C=y.xhr,w=s.trim,A=m.cache.storage.adapter,x=z.isWebkit(),E=z.hasCanvas(),F=[{type:"fileSystem",
css:!0,js:!0,html:!0,img:!0},{type:"indexedDatabase",css:!0,js:!0,html:!0,img:!0},{type:"webSqlDatabase",css:!0,js:!0,html:!0,img:!0},{type:"webStorage",css:!0,js:!0,html:!0,img:!0}],D={name:"localcache",table:"cache",description:"local resource cache",size:4194304,version:"1.0",key:"key",lifetime:"local",offline:!0},B=null,G={ajax:!0,lifetime:2E4,group:0,lastmod:(new Date).getTime(),type:"css",version:1};u.prototype=u.fn={create:function(b,d){d=t(d);if(b&&b.url){var g=this,f=b.url,h=b.type;a(b,function(a){if(a)if(b.data=
a,b=n(b),null!==g.adapter&&c(h)){a=k.jsonToString(f);var l=e(b,g.resources.defaults),m=k.jsonToString(l);b.expires=l.expires;b.version=l.version;try{g.adapter.create(a,m,function(a){a?d(b):d(!1)})}catch(t){d(b)}}else d(b);else d(b)},d)}else d(!1)},read:function(a,b){b=t(b);if(a&&a.url){var d=this,g=a.url,e=a.type;if(null!==this.adapter&&c(e))try{d.adapter.read(k.jsonToString(g),function(c){c?(a=p(c))?(a.url=g,b(a,!0)):d.remove({url:g,type:e},function(){b(!1)}):b(!1)})}catch(h){f(g,function(c){a.data=
c;b(a,!0)},a)}else b(a)}else b(!1)},update:function(b,d){d=t(d);if(b&&b.url){var g=this,f=b.url,h=b.type;a(b,function(a){if(a)if(b.data=a,b=n(b),null!==g.adapter&&c(h)){a=k.jsonToString(f);var l=e(b,g.resources.defaults),m=k.jsonToString(l);b.expires=l.expires;b.version=l.version;try{g.adapter.update(a,m,function(a){a?d(b):d(!1)})}catch(t){d(b)}}else d(b);else g.read(b,function(a){a&&a.data?(b.data=a.data,d(b)):d(!1)})},d)}else d(!1)},remove:function(a,b){b=t(b);if(a&&a.url){var d=a.url,g=a.type;
null!==this.adapter&&c(g)?this.adapter.remove(k.jsonToString(d),function(c){c?b(a):b(!1)}):b(a)}else b(!1)},init:function(a,b){var c=this,g=!1,f,e,h,k;a=t(a);b&&b.isEnabled!==d&&(c.isEnabled=!!b.isEnabled);if(c.isEnabled&&v){if(b){if(b.adapters){f=b.adapters;if(f.types&&r(f.types)){e=f.types;h=e.length;for(k=0;k<h;k+=1)e[k].css===d&&(e[k].css=!0),e[k].js===d&&(e[k].js=!0),e[k].img===d&&(e[k].img=!0),e[k].html===d&&(e[k].html=!0);c.adapters.types=e}f.defaults&&(e=f.defaults,h=c.adapters.defaults,e.name&&
(h.name=w(String(e.name))),e.table&&(h.table=w(String(e.table))),e.description&&(h.description=w(String(e.description))),e.size&&(h.size=parseInt(e.size,10)),e.version&&(h.version=w(String(e.version))),e.key&&(h.key=w(String(e.key))),e.lifetime&&(h.lifetime=w(String(e.lifetime))),e.offline!==d&&(h.offline=!!e.offline));f.preferredType&&(g=w(String(f.preferredType)))}b.resources&&(f=b.resources,f.defaults&&(f=f.defaults,e=c.resources.defaults,f.ajax!==d&&(e.ajax=!!f.ajax),f.lifetime!==d&&(e.lifetime=
parseInt(f.lifetime,10)),f.group!==d&&(e.group=parseInt(f.group,10)),f.lastmod!==d&&(e.lastmod=parseInt(f.lastmod,10)),f.type&&(e.type=w(String(f.type))),f.group!==d&&(e.version=parseFloat(f.version)),f.loaded&&(e.loaded=t(f.loaded))))}l(function(b){b||(c.isEnabled=!1);c.adapter=b;a(c)},c.adapters.types,g);c.adapters.defaults.offline&&(A.applicationCache&&!c.appCacheAdapter)&&(c.appCacheAdapter=new A.applicationCache(D))}else a(c)}};m.ns("cache.storage.controller",u)})(window,document,window.getNs());
(function(h,q){function m(c){var d=a(c.type);if("js"!==d||"css"!==d||"html"!==d||"img"!==d||"custom"!==d){switch(b.url(c.url).extension){case "js":c="js";break;case "css":c="css";break;case "html":c="html";break;case "jpg":case "jpeg":case "png":c="img";break;default:c="custom"}d=c}return d}function d(a,b){if(!(this instanceof d))return new d(a,b);this.storage=null;this.init(a,b)}var f=h.helpers,p=f.dom,b=f.utils,n=f.client,e=b.isArray,a=b.trim,c=b.callback;d.prototype=d.fn={load:function(b,d){var f=
this,h=(new Date).getTime(),z=function(){var a=0,b=0,c=null;return{init:function(d,f){c=f;a=d;b=0},loaded:function(){b+=1;b===a&&c()}}}(),s=function(a,b,c){var d=a.url,f=function(){a.loaded(a);z.loaded()},e=a.node||null;c=!!c;switch(a.type){case "js":p.appendJs(d,b,f,e,c);break;case "css":p.appendCss(d,b,f,e,c);break;case "img":p.appendImg(d,b,f,e,c);break;case "html":p.appendHtml(d,b,f,e,c);break;default:f()}},k=function(a){var b=a.data||null,d=function(a,b){a&&a.data?s(a,a.data,b):s(a,null,b)},
e=f.storage,g=e.resources.defaults;a.ajax=a.ajax!==q?!!a.ajax:g.ajax;a.loaded=a.loaded!==q?c(a.loaded):c(g.loaded);e.read(a,function(c){if(c&&c.data){var g=a,k=f.storage.resources.defaults,l=parseInt(c.lifetime,10),m=c.version,t=c.lastmod?c.lastmod:0,r=!1,p,x=g.lastmod?g.lastmod:0,r=!0;p=!1;g.version=p=g.version!==q?parseFloat(g.version):k.version;g.group=g.group!==q?parseFloat(g.group):k.group;x&&t?(g.lastmod=parseInt(x,10),r=t===g.lastmod):!x&&t?x=t:x||(x=k.lastmod);r=r&&p===m;p=0!==l&&(-1!==l&&
r&&c.expires>h||-1===l&&r);g.lastmod=x;g.isValid=p;a=g;a.isValid||!n.isOnline()?(b=c.data)&&s(a,b):e.update(a,d)}else e.create(a,d)})},r=function(b,c){var d=0,f=b.length,e=null;z.init(f,c);for(d=0;d<f;d+=1)(e=b[d])&&e.url&&(e.url=a(e.url),e.type=m(e),k(e))},t=function(a,b,c){var d=a.length;for(c||(c=0);!a[c]&&c<d;)c+=1;c>=d?b(f):(d=a[c],r(d,function(){t(a,b,c+1)}))};(function(a,b){a&&e(a)||(a=[]);for(var f=a,g=[],h,k=0,m,r=f.length,k=0;k<r;k+=1)m=f[k],(h=m.group)||(h=0),h=g[h]?g[h]:g[h]=[],h.push(m);
a=g;b=c(d);t(a,b)})(b,d)},remove:function(b,d){var f=this.storage,h=function(b,c){var d=b.length,e,g,h=function(a,b){a===d-1&&c()};if(d)for(e=0;e<d;e+=1)(g=b[e])&&g.url&&(g.url=a(g.url),g.type=m(g),f.remove(g,h(e,g.url)));else c()};(function(a,b){a&&e(a)||(a=[]);b=c(d);h(a,b)})(b,d)},init:function(a,b){var d=this;a=c(a);h.cache.storage.controller(function(b){d.storage=b;a(b)},b);return d}};h.ns("cache.controller",d)})(window.getNs());
(function(h,q,m){function d(a){this.storage=this.controller=null;this.params=a;this.queue=new e;this.timeout=this.interval=this.calls=0}function f(a){var e=null,f=b.length,h;a||(a=z);if(c)for(h=0;h<f;h+=1)b[h]&&g(b[h].params)===g(a)&&(e=b[h]);e||(e=new d(a),b.push(e));return e}function p(a,b,c){var d=f(a),e,g,l,m=function(){e=d.interval;h.clearInterval(e);e=h.setInterval(function(){d.timeout=g=d.timeout+u;l=d.storage;d.controller&&(l&&(l.adapter||!l.isEnabled))&&(h.clearInterval(e),d.queue.flush());
g>y&&(h.clearInterval(e),c())},u)};d?d.storage?b(d):(d.queue.add(function(){b(d)}),d.calls+=1,1===d.calls?d.controller=new q.cache.controller(function(a){d.storage=a;d.controller?d.queue.flush():m()},a):m()):c()}var b=[],n=q.helpers,e=n.queue;m=n.utils;var n=n.json,a=m.isArray,c=n.getJson(),g=n.jsonToString,l=m.callback,u=15,y=5E3,z={};m=function(){return{load:function(b,c,d){c=l(c);p(d,function(e){a(b)?e.controller.load(b,c):"applicationCache"===b?(e=e.storage)&&e.appCacheAdapter?e.appCacheAdapter.open(c,
d):c(!1):c(!1)},function(){c(!1)});return this},remove:function(b,c,d){c=l(c);p(d,function(d){a(b)?d.controller.remove(b,c):c(!1)},function(){c(!1)});return this},setup:function(a){a&&(z=a);return this}}}();q.ns("cache.load",m.load);q.ns("cache.remove",m.remove);q.ns("cache.setup",m.setup)})(window,window.getNs());
